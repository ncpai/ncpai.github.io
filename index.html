<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTIMATE BACCARAT AI SYSTEM - Pattern Recognition Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1a3e 25%, #16213e 50%, #0f3460 75%, #1e1e3f 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 15px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(102, 126, 234, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(240, 84, 84, 0.03) 0%, transparent 50%);
            pointer-events: none;
            animation: backgroundFloat 30s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes backgroundFloat {
            0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); }
            25% { transform: translate(-20px, -20px) scale(1.02) rotate(1deg); }
            50% { transform: translate(20px, -10px) scale(0.98) rotate(-1deg); }
            75% { transform: translate(-10px, 20px) scale(1.01) rotate(0.5deg); }
        }

        .smart-container {
            max-width: 1600px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        /* Smart Header */
        .smart-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .smart-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: headerShine 3s linear infinite;
        }

        @keyframes headerShine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(270deg, #ffd700, #ff6b6b, #4ecdc4, #667eea, #ffd700);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: gradientFlow 4s ease infinite;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .ai-status {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 255, 0, 0.1);
            padding: 8px 20px;
            border-radius: 20px;
            border: 1px solid rgba(0, 255, 0, 0.3);
            margin-top: 10px;
        }

        .ai-status::before {
            content: '';
            width: 8px;
            height: 8px;
            background: #00ff00;
            border-radius: 50%;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        /* Mode Selector */
        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .mode-btn {
            padding: 12px 30px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            color: white;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        /* Mode Sections */
        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Training Section */
        .training-section {
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.08) 0%, rgba(79, 70, 229, 0.08) 100%);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid rgba(147, 51, 234, 0.3);
        }

        .training-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .training-title {
            font-size: 1.4em;
            color: #a78bfa;
            font-weight: bold;
        }

        .training-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .training-stat {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }

        .training-stat-label {
            font-size: 0.9em;
            color: #aaa;
            margin-bottom: 5px;
        }

        .training-stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffd700;
        }

        .training-input {
            margin-bottom: 20px;
        }

        .session-input-area {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .session-input-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .session-label {
            font-weight: bold;
            color: #ffd700;
        }

        .session-counter {
            background: rgba(255, 215, 0, 0.2);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .input-textarea {
            width: 100%;
            min-height: 100px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px;
            color: white;
            font-family: monospace;
            font-size: 1.1em;
            resize: vertical;
        }

        .input-helper {
            font-size: 0.85em;
            color: #aaa;
            margin-top: 5px;
        }

        .training-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .action-btn:hover::before {
            left: 100%;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .action-btn.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .action-btn.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .action-btn.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        /* Pattern Database Display */
        .pattern-database {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .database-header {
            font-size: 1.2em;
            color: #ffd700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .pattern-list {
            display: grid;
            gap: 10px;
        }

        .pattern-entry {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .pattern-entry:hover {
            background: rgba(255, 215, 0, 0.1);
        }

        .pattern-key {
            font-family: monospace;
            font-size: 1.1em;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .pattern-stats {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .pattern-stat {
            padding: 4px 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 6px;
            font-size: 0.9em;
        }

        /* Playing Section */
        .playing-section {
            background: linear-gradient(135deg, rgba(46, 213, 115, 0.08) 0%, rgba(0, 184, 148, 0.08) 100%);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid rgba(46, 213, 115, 0.3);
        }

        .playing-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .playing-title {
            font-size: 1.4em;
            color: #4fd1c5;
            font-weight: bold;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
        }

        .quick-btn {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .quick-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Smart Buttons Grid */
        .smart-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .smart-btn {
            padding: 25px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.2em;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            border: 2px solid transparent;
            color: white;
        }

        .smart-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .smart-btn:hover::before {
            left: 100%;
        }

        .smart-btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        .smart-btn.player {
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-color: #3498db;
        }

        .smart-btn.banker {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
        }

        .smart-btn.tie {
            background: linear-gradient(135deg, #27ae60, #229954);
            border-color: #27ae60;
        }

        .smart-btn .icon {
            font-size: 2em;
        }

        .smart-btn .label {
            font-size: 1.1em;
        }

        .smart-btn .sub-label {
            font-size: 0.8em;
            opacity: 0.8;
        }

        /* Pattern Analysis Section */
        .pattern-analysis {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.08) 0%, rgba(102, 126, 234, 0.08) 100%);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .pattern-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .pattern-title {
            font-size: 1.3em;
            color: #ffd700;
            font-weight: bold;
        }

        .current-pattern {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            align-items: center;
        }

        .pattern-label {
            color: #aaa;
            margin-right: 10px;
        }

        .pattern-item {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
        }

        .pattern-item.player {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .pattern-item.banker {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .pattern-item.tie {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .pattern-item.empty {
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .pattern-matches {
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .match-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .match-item:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: translateX(5px);
        }

        .match-pattern {
            font-family: monospace;
            font-size: 1.1em;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .match-stats {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .match-count {
            background: rgba(255, 215, 0, 0.2);
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 0.9em;
        }

        .match-percent {
            font-size: 1.2em;
            font-weight: bold;
            color: #ffd700;
        }

        /* Predictions Dashboard */
        .predictions-dashboard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .prediction-tile {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .prediction-tile.hot {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2) 0%, rgba(255, 107, 107, 0.1) 100%);
            border-color: #ff6b6b;
            animation: hotPulse 1.5s ease-in-out infinite;
        }

        .prediction-tile.very-hot {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.3) 0%, rgba(255, 107, 107, 0.15) 100%);
            border-color: #ff0000;
            animation: veryHotPulse 1s ease-in-out infinite;
        }

        @keyframes hotPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 107, 0.5); }
            50% { box-shadow: 0 0 40px rgba(255, 107, 107, 0.8); }
        }

        @keyframes veryHotPulse {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(255, 0, 0, 0.6);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 50px rgba(255, 0, 0, 0.9);
                transform: scale(1.02);
            }
        }

        .prediction-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .prediction-label {
            font-size: 0.9em;
            color: #aaa;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .prediction-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .prediction-bar {
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .prediction-fill {
            height: 100%;
            transition: width 0.5s ease;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .confidence-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 0.8em;
        }

        /* AI Recommendation Panel */
        .ai-recommendation {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 107, 107, 0.15) 100%);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 25px;
            border: 3px solid #ffd700;
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: recommendGlow 3s ease-in-out infinite;
        }

        @keyframes recommendGlow {
            0%, 100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.4); }
            50% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.6); }
        }

        .ai-recommendation::before {
            content: '‚≠ê';
            position: absolute;
            font-size: 150px;
            opacity: 0.05;
            top: -30px;
            right: -30px;
            transform: rotate(15deg);
        }

        .recommend-title {
            font-size: 1.8em;
            color: #ffd700;
            margin-bottom: 20px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .recommend-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .recommend-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px 30px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .recommend-card:hover {
            transform: translateY(-5px) scale(1.05);
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
        }

        .recommend-card.primary {
            background: rgba(255, 215, 0, 0.3);
            border-color: #ffd700;
            animation: primaryPulse 2s ease-in-out infinite;
        }

        @keyframes primaryPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        .recommend-bet {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .recommend-confidence {
            font-size: 2em;
            color: #ffd700;
            font-weight: bold;
        }

        .recommend-reason {
            font-size: 0.9em;
            color: #aaa;
            margin-top: 10px;
        }

        /* Smart Statistics Grid */
        .smart-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(46, 213, 115, 0.1) 0%, rgba(0, 184, 148, 0.1) 100%);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(46, 213, 115, 0.3);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .stat-icon {
            font-size: 1.5em;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .stat-label {
            font-size: 0.85em;
            color: #aaa;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #4fd1c5;
        }

        /* History Timeline */
        .history-timeline {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .history-title {
            font-size: 1.2em;
            color: #fff;
        }

        .history-count {
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .history-track {
            display: flex;
            gap: 5px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            overflow-x: auto;
            max-height: 80px;
            align-items: center;
        }

        .history-item {
            min-width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .history-item:hover {
            transform: scale(1.2);
            z-index: 10;
        }

        .history-item.player {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .history-item.banker {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .history-item.tie {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        /* Loading Animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            gap: 15px;
        }
        
        .loading-overlay.show {
            display: flex;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        .loading-text {
            color: #ffd700;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Alert System */
        .smart-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%);
            color: #333;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            z-index: 1000;
            display: none;
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }
        
        @keyframes slideIn { 
            from { transform: translateX(100%); opacity: 0; } 
            to { transform: translateX(0); opacity: 1; } 
        }
        
        .smart-alert.show { display: block; }
        .smart-alert.success { border-left: 5px solid #00ff00; }
        .smart-alert.warning { border-left: 5px solid #ffa500; }
        .smart-alert.info { border-left: 5px solid #00bfff; }

        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .predictions-dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .smart-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            .smart-buttons { grid-template-columns: 1fr; }
            .predictions-dashboard { grid-template-columns: 1fr; }
            .smart-stats { grid-template-columns: 1fr; }
            .recommend-cards { flex-direction: column; }
            .mode-selector { flex-direction: column; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.05); border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #764ba2, #667eea); }
    </style>
</head>
<body>
    <div class="smart-container">
        <div class="smart-header">
            <h1>üé∞ ULTIMATE BACCARAT AI SYSTEM üé∞</h1>
            <div class="ai-status">AI PATTERN RECOGNITION ACTIVE</div>
        </div>

        <!-- Mode Selector -->
        <div class="mode-selector">
            <button class="mode-btn active" onclick="switchMode('training')" id="trainingModeBtn">
                üìö CH·∫æ ƒê·ªò TRAINING
            </button>
            <button class="mode-btn" onclick="switchMode('playing')" id="playingModeBtn">
                üéÆ CH·∫æ ƒê·ªò PLAYING
            </button>
        </div>

        <!-- Training Mode Section -->
        <div class="mode-section active" id="trainingMode">
            <div class="training-section">
                <div class="training-header">
                    <div class="training-title">üìö TRAINING D·ªÆ LI·ªÜU L·ªäCH S·ª¨</div>
                </div>

                <div class="training-stats">
                    <div class="training-stat">
                        <div class="training-stat-label">T·ªïng phi√™n ƒë√£ n·∫°p</div>
                        <div class="training-stat-value" id="trainingSessions">0</div>
                    </div>
                    <div class="training-stat">
                        <div class="training-stat-label">T·ªïng v√°n ƒë√£ h·ªçc</div>
                        <div class="training-stat-value" id="trainingGames">0</div>
                    </div>
                    <div class="training-stat">
                        <div class="training-stat-label">Chu·ªói pattern</div>
                        <div class="training-stat-value" id="trainingPatterns">0</div>
                    </div>
                    <div class="training-stat">
                        <div class="training-stat-label">Chu·ªói h·ª£p l·ªá</div>
                        <div class="training-stat-value" id="validPatterns">0</div>
                    </div>
                </div>

                <div class="training-input">
                    <div class="session-input-area">
                        <div class="session-input-header">
                            <div class="session-label">Nh·∫≠p d·ªØ li·ªáu phi√™n:</div>
                            <div class="session-counter">Phi√™n <span id="currentSessionNum">1</span></div>
                        </div>
                        <textarea class="input-textarea" id="sessionInput" placeholder="Nh·∫≠p k·∫øt qu·∫£: PPBBTPPPBBBTTPPBBB..."></textarea>
                        <div class="input-helper">
                            üí° Nh·∫≠p chu·ªói k·∫øt qu·∫£: P (Player/Con), B (Banker/C√°i), T (Tie/H√≤a). 
                            V√≠ d·ª•: PPBBTPPBBBTTPPBBB (kh√¥ng c·∫ßn d·∫•u c√°ch)
                        </div>
                    </div>
                </div>

                <div class="training-actions">
                    <button class="action-btn success" onclick="addSession()">
                        ‚ûï Th√™m Phi√™n
                    </button>
                    <button class="action-btn" onclick="loadDemoSessions()">
                        üé≤ N·∫°p 20 Phi√™n Demo
                    </button>
                    <button class="action-btn warning" onclick="clearLastSession()">
                        ‚Ü©Ô∏è X√≥a Phi√™n Cu·ªëi
                    </button>
                    <button class="action-btn danger" onclick="clearAllTraining()">
                        üóëÔ∏è X√≥a To√†n B·ªô
                    </button>
                </div>

                <div class="pattern-database" id="patternDatabase">
                    <div class="database-header">üìä Database Pattern (Top 20)</div>
                    <div class="pattern-list" id="patternList">
                        <!-- Patterns will be displayed here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Playing Mode Section -->
        <div class="mode-section" id="playingMode">
            <div class="playing-section">
                <div class="playing-header">
                    <div class="playing-title">üéÆ CH∆†I TH·ª∞C T·∫æ</div>
                    <div class="quick-actions">
                        <button class="quick-btn" onclick="undoLast()">‚Ü©Ô∏è Ho√†n t√°c</button>
                        <button class="quick-btn" onclick="clearPlaying()">üóëÔ∏è X√≥a l·ªãch s·ª≠ ch∆°i</button>
                    </div>
                </div>

                <div class="smart-buttons">
                    <button class="smart-btn player" onclick="addPlayResult('P')" id="btnPlayer">
                        <div class="icon">üë§</div>
                        <div class="label">CON</div>
                        <div class="sub-label">Player</div>
                    </button>
                    <button class="smart-btn banker" onclick="addPlayResult('B')" id="btnBanker">
                        <div class="icon">üè¶</div>
                        <div class="label">C√ÅI</div>
                        <div class="sub-label">Banker</div>
                    </button>
                    <button class="smart-btn tie" onclick="addPlayResult('T')" id="btnTie">
                        <div class="icon">ü§ù</div>
                        <div class="label">H√íA</div>
                        <div class="sub-label">Tie</div>
                    </button>
                </div>
            </div>

            <div class="pattern-analysis">
                <div class="pattern-header">
                    <div class="pattern-title">üîç PH√ÇN T√çCH CHU·ªñI 6 V√ÅN</div>
                </div>
                <div class="current-pattern">
                    <span class="pattern-label">Chu·ªói hi·ªán t·∫°i:</span>
                    <div id="currentPatternDisplay"></div>
                </div>
                <div class="pattern-matches" id="patternMatches">
                    <!-- Pattern matches will be displayed here -->
                </div>
            </div>

            <div class="predictions-dashboard">
                <div class="prediction-tile" id="predPlayer">
                    <div class="confidence-badge" id="confPlayer">0 l·∫ßn</div>
                    <div class="prediction-icon">üë§</div>
                    <div class="prediction-label">CON</div>
                    <div class="prediction-value" id="probPlayer">0%</div>
                    <div class="prediction-bar">
                        <div class="prediction-fill" id="barPlayer" style="width: 0%"></div>
                    </div>
                </div>
                <div class="prediction-tile" id="predBanker">
                    <div class="confidence-badge" id="confBanker">0 l·∫ßn</div>
                    <div class="prediction-icon">üè¶</div>
                    <div class="prediction-label">C√ÅI</div>
                    <div class="prediction-value" id="probBanker">0%</div>
                    <div class="prediction-bar">
                        <div class="prediction-fill" id="barBanker" style="width: 0%; background: linear-gradient(90deg, #e74c3c, #c0392b)"></div>
                    </div>
                </div>
                <div class="prediction-tile" id="predTie">
                    <div class="confidence-badge" id="confTie">0 l·∫ßn</div>
                    <div class="prediction-icon">ü§ù</div>
                    <div class="prediction-label">H√íA</div>
                    <div class="prediction-value" id="probTie">0%</div>
                    <div class="prediction-bar">
                        <div class="prediction-fill" id="barTie" style="width: 0%; background: linear-gradient(90deg, #27ae60, #229954)"></div>
                    </div>
                </div>
            </div>

            <div class="ai-recommendation" id="aiRecommend">
                <div class="recommend-title">üíé AI ƒê·ªÄ XU·∫§T üíé</div>
                <div class="recommend-cards" id="recommendCards">
                    <div style="color: #888;">C·∫ßn √≠t nh·∫•t 5 v√°n ƒë·ªÉ AI ƒë·ªÅ xu·∫•t...</div>
                </div>
            </div>

            <div class="smart-stats">
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-label">V√°n ƒë√£ ch∆°i</div>
                    <div class="stat-value" id="playedGames">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-label">D·ª± ƒëo√°n ƒë√∫ng</div>
                    <div class="stat-value" id="correctPredictions">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-label">ƒê·ªô ch√≠nh x√°c</div>
                    <div class="stat-value" id="accuracy">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-label">Chu·ªói hi·ªán t·∫°i</div>
                    <div class="stat-value" id="currentStreak">-</div>
                </div>
            </div>

            <div class="history-timeline">
                <div class="history-header">
                    <div class="history-title">üìú L·ªãch s·ª≠ ch∆°i</div>
                    <div class="history-count">T·ªïng: <span id="historyCount">0</span></div>
                </div>
                <div class="history-track" id="historyTrack">
                    <div style="color: #888;">Ch∆∞a c√≥ d·ªØ li·ªáu</div>
                </div>
            </div>
        </div>

        <div class="smart-alert" id="smartAlert"></div>

        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loadingText">ƒêANG X·ª¨ L√ù...</div>
        </div>
    </div>

    <script>
        // ===============================================
        // PATTERN-BASED BACCARAT AI SYSTEM WITH SEPARATE TRAINING
        // ===============================================

        class PatternBaccaratAI {
            constructor() {
                this.SEQUENCE_LENGTH = 6;
                
                // Training data
                this.trainingSessions = [];
                this.patternDatabase = new Map();
                this.trainingStats = {
                    totalSessions: 0,
                    totalGames: 0,
                    totalPatterns: 0,
                    validPatterns: 0
                };
                
                // Playing data
                this.playingHistory = [];
                this.predictions = { P: 0, B: 0, T: 0 };
                this.playingStats = {
                    gamesPlayed: 0,
                    correctPredictions: 0,
                    totalPredictions: 0,
                    currentStreak: { type: null, count: 0 }
                };
                this.lastPrediction = null;
            }

            // Check if sequence is invalid (c·∫ßu b·ªát or c·∫ßu 11)
            isInvalidSequence(sequence) {
                if (sequence.length !== this.SEQUENCE_LENGTH) return true;
                
                // Check if all same (c·∫ßu b·ªát)
                const allSame = sequence.every(val => val === sequence[0]);
                if (allSame) return true;
                
                // Check if alternating pattern (c·∫ßu 11)
                let isAlternating = true;
                for (let i = 0; i < sequence.length - 1; i++) {
                    if (sequence[i] === sequence[i + 1] || sequence[i] === 'T') {
                        isAlternating = false;
                        break;
                    }
                }
                
                return isAlternating;
            }

            // TRAINING METHODS
            addTrainingSession(sessionData) {
                // Validate input
                const validChars = /^[PBT]+$/i;
                if (!validChars.test(sessionData)) {
                    throw new Error('D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá! Ch·ªâ s·ª≠ d·ª•ng P, B, T');
                }
                
                const session = sessionData.toUpperCase().split('');
                if (session.length < 20) {
                    throw new Error('Phi√™n ph·∫£i c√≥ √≠t nh·∫•t 20 v√°n!');
                }
                
                // Process patterns in the session
                let validCount = 0;
                for (let i = 0; i <= session.length - this.SEQUENCE_LENGTH; i++) {
                    const sequence = session.slice(i, i + this.SEQUENCE_LENGTH);
                    this.trainingStats.totalPatterns++;
                    
                    if (!this.isInvalidSequence(sequence)) {
                        this.addPatternToDatabase(sequence);
                        validCount++;
                        this.trainingStats.validPatterns++;
                    }
                }
                
                // Save session
                this.trainingSessions.push(session);
                this.trainingStats.totalSessions++;
                this.trainingStats.totalGames += session.length;
                
                return {
                    sessionLength: session.length,
                    patternsFound: session.length - this.SEQUENCE_LENGTH + 1,
                    validPatterns: validCount
                };
            }

            addPatternToDatabase(sequence) {
                const patternKey = sequence.slice(0, 5).join('');
                const nextResult = sequence[5];
                
                if (!this.patternDatabase.has(patternKey)) {
                    this.patternDatabase.set(patternKey, { 
                        P: 0, B: 0, T: 0, total: 0 
                    });
                }
                
                const pattern = this.patternDatabase.get(patternKey);
                pattern[nextResult]++;
                pattern.total++;
            }

            loadDemoSessions() {
                // Clear existing training data
                this.clearTraining();
                
                // Generate 20 demo sessions
                for (let s = 0; s < 20; s++) {
                    const sessionLength = 65 + Math.floor(Math.random() * 6);
                    let sessionData = '';
                    
                    for (let i = 0; i < sessionLength; i++) {
                        const rand = Math.random();
                        if (rand < 0.45) sessionData += 'P';
                        else if (rand < 0.9) sessionData += 'B';
                        else sessionData += 'T';
                    }
                    
                    this.addTrainingSession(sessionData);
                }
            }

            clearLastSession() {
                if (this.trainingSessions.length === 0) return false;
                
                // Remove last session and rebuild database
                this.trainingSessions.pop();
                this.rebuildDatabase();
                return true;
            }

            clearTraining() {
                this.trainingSessions = [];
                this.patternDatabase.clear();
                this.trainingStats = {
                    totalSessions: 0,
                    totalGames: 0,
                    totalPatterns: 0,
                    validPatterns: 0
                };
            }

            rebuildDatabase() {
                this.patternDatabase.clear();
                this.trainingStats = {
                    totalSessions: this.trainingSessions.length,
                    totalGames: 0,
                    totalPatterns: 0,
                    validPatterns: 0
                };
                
                for (const session of this.trainingSessions) {
                    this.trainingStats.totalGames += session.length;
                    
                    for (let i = 0; i <= session.length - this.SEQUENCE_LENGTH; i++) {
                        const sequence = session.slice(i, i + this.SEQUENCE_LENGTH);
                        this.trainingStats.totalPatterns++;
                        
                        if (!this.isInvalidSequence(sequence)) {
                            this.addPatternToDatabase(sequence);
                            this.trainingStats.validPatterns++;
                        }
                    }
                }
            }

            getTopPatterns(limit = 20) {
                const patterns = Array.from(this.patternDatabase.entries())
                    .map(([key, stats]) => ({ pattern: key, ...stats }))
                    .sort((a, b) => b.total - a.total)
                    .slice(0, limit);
                
                return patterns;
            }

            // PLAYING METHODS
            addPlayResult(result) {
                // Check prediction accuracy
                if (this.lastPrediction && this.playingHistory.length >= 5) {
                    this.playingStats.totalPredictions++;
                    if (this.lastPrediction === result) {
                        this.playingStats.correctPredictions++;
                    }
                }

                // Add to playing history
                this.playingHistory.push(result);
                this.playingStats.gamesPlayed++;
                
                // Update streak
                if (this.playingStats.currentStreak.type === result) {
                    this.playingStats.currentStreak.count++;
                } else {
                    this.playingStats.currentStreak.type = result;
                    this.playingStats.currentStreak.count = 1;
                }
                
                // Predict next if we have enough data
                if (this.playingHistory.length >= 5) {
                    this.predictNext();
                }
            }

            predictNext() {
                if (this.playingHistory.length < 5) {
                    this.predictions = { P: 33.33, B: 33.33, T: 33.34 };
                    this.lastPrediction = null;
                    return this.predictions;
                }
                
                const currentPattern = this.playingHistory.slice(-5).join('');
                const patternData = this.patternDatabase.get(currentPattern);
                
                if (patternData && patternData.total > 0) {
                    this.predictions = {
                        P: (patternData.P / patternData.total) * 100,
                        B: (patternData.B / patternData.total) * 100,
                        T: (patternData.T / patternData.total) * 100
                    };
                    
                    // Determine most likely prediction
                    const maxProb = Math.max(this.predictions.P, this.predictions.B, this.predictions.T);
                    if (maxProb === this.predictions.P) this.lastPrediction = 'P';
                    else if (maxProb === this.predictions.B) this.lastPrediction = 'B';
                    else this.lastPrediction = 'T';
                } else {
                    this.predictions = { P: 33.33, B: 33.33, T: 33.34 };
                    this.lastPrediction = null;
                }
                
                return this.predictions;
            }

            findMatchingPatterns(currentPattern) {
                const matches = [];
                
                if (this.patternDatabase.has(currentPattern)) {
                    const pattern = this.patternDatabase.get(currentPattern);
                    matches.push({
                        pattern: currentPattern,
                        counts: pattern,
                        exact: true
                    });
                }
                
                return matches;
            }

            getCurrentSequence() {
                const last5 = this.playingHistory.slice(-5);
                return last5.length < 5 ? 
                    [...last5, ...Array(5 - last5.length).fill('')] : 
                    last5;
            }

            getAccuracy() {
                if (this.playingStats.totalPredictions === 0) return 0;
                return (this.playingStats.correctPredictions / this.playingStats.totalPredictions) * 100;
            }

            undoLastPlay() {
                if (this.playingHistory.length > 0) {
                    this.playingHistory.pop();
                    this.playingStats.gamesPlayed--;
                    if (this.playingHistory.length >= 5) {
                        this.predictNext();
                    } else {
                        this.predictions = { P: 33.33, B: 33.33, T: 33.34 };
                    }
                }
            }

            clearPlaying() {
                this.playingHistory = [];
                this.predictions = { P: 33.33, B: 33.33, T: 33.34 };
                this.playingStats = {
                    gamesPlayed: 0,
                    correctPredictions: 0,
                    totalPredictions: 0,
                    currentStreak: { type: null, count: 0 }
                };
                this.lastPrediction = null;
            }
        }

        // ====================================
        // GLOBAL SYSTEM INSTANCE
        // ====================================

        const AI = new PatternBaccaratAI();
        let currentMode = 'training';
        let isProcessing = false;

        // ====================================
        // MODE SWITCHING
        // ====================================

        function switchMode(mode) {
            currentMode = mode;
            
            // Update buttons
            document.getElementById('trainingModeBtn').classList.toggle('active', mode === 'training');
            document.getElementById('playingModeBtn').classList.toggle('active', mode === 'playing');
            
            // Update sections
            document.getElementById('trainingMode').classList.toggle('active', mode === 'training');
            document.getElementById('playingMode').classList.toggle('active', mode === 'playing');
            
            // Update UI based on mode
            if (mode === 'training') {
                updateTrainingUI();
            } else {
                updatePlayingUI();
            }
        }

        // ====================================
        // TRAINING MODE FUNCTIONS
        // ====================================

        function addSession() {
            const input = document.getElementById('sessionInput').value.trim();
            
            if (!input) {
                showAlert('warning', '‚ö†Ô∏è Vui l√≤ng nh·∫≠p d·ªØ li·ªáu phi√™n!');
                return;
            }
            
            try {
                showLoading();
                const result = AI.addTrainingSession(input);
                
                document.getElementById('sessionInput').value = '';
                document.getElementById('currentSessionNum').textContent = AI.trainingStats.totalSessions + 1;
                
                updateTrainingUI();
                hideLoading();
                showAlert('success', `‚úÖ ƒê√£ th√™m phi√™n ${AI.trainingStats.totalSessions} (${result.sessionLength} v√°n, ${result.validPatterns} chu·ªói h·ª£p l·ªá)`);
            } catch (error) {
                hideLoading();
                showAlert('warning', `‚ö†Ô∏è ${error.message}`);
            }
        }

        function loadDemoSessions() {
            if (!confirm('N·∫°p 20 phi√™n demo? (S·∫Ω x√≥a d·ªØ li·ªáu training hi·ªán t·∫°i)')) return;
            
            showLoading();
            setLoadingText('ƒêANG N·∫†P 20 PHI√äN DEMO...');
            
            setTimeout(() => {
                AI.loadDemoSessions();
                updateTrainingUI();
                hideLoading();
                showAlert('success', '‚úÖ ƒê√£ n·∫°p 20 phi√™n demo th√†nh c√¥ng!');
            }, 1000);
        }

        function clearLastSession() {
            if (AI.trainingSessions.length === 0) {
                showAlert('warning', '‚ö†Ô∏è Kh√¥ng c√≥ phi√™n n√†o ƒë·ªÉ x√≥a!');
                return;
            }
            
            if (!confirm('X√≥a phi√™n cu·ªëi c√πng?')) return;
            
            showLoading();
            AI.clearLastSession();
            document.getElementById('currentSessionNum').textContent = AI.trainingStats.totalSessions + 1;
            updateTrainingUI();
            hideLoading();
            showAlert('info', '‚Ü©Ô∏è ƒê√£ x√≥a phi√™n cu·ªëi');
        }

        function clearAllTraining() {
            if (!confirm('X√≥a to√†n b·ªô d·ªØ li·ªáu training?')) return;
            
            showLoading();
            AI.clearTraining();
            document.getElementById('currentSessionNum').textContent = '1';
            updateTrainingUI();
            hideLoading();
            showAlert('info', 'üóëÔ∏è ƒê√£ x√≥a to√†n b·ªô d·ªØ li·ªáu training');
        }

        function updateTrainingUI() {
            // Update statistics
            document.getElementById('trainingSessions').textContent = AI.trainingStats.totalSessions;
            document.getElementById('trainingGames').textContent = AI.trainingStats.totalGames;
            document.getElementById('trainingPatterns').textContent = AI.trainingStats.totalPatterns;
            document.getElementById('validPatterns').textContent = AI.trainingStats.validPatterns;
            
            // Update pattern database display
            const patterns = AI.getTopPatterns(20);
            const patternList = document.getElementById('patternList');
            
            if (patterns.length === 0) {
                patternList.innerHTML = '<div style="color: #888; text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu pattern</div>';
            } else {
                patternList.innerHTML = patterns.map(p => {
                    const pPercent = ((p.P / p.total) * 100).toFixed(1);
                    const bPercent = ((p.B / p.total) * 100).toFixed(1);
                    const tPercent = ((p.T / p.total) * 100).toFixed(1);
                    
                    return `
                        <div class="pattern-entry">
                            <div class="pattern-key">${p.pattern}</div>
                            <div class="pattern-stats">
                                <div class="pattern-stat">T·ªïng: ${p.total}</div>
                                <div class="pattern-stat">P: ${pPercent}%</div>
                                <div class="pattern-stat">B: ${bPercent}%</div>
                                <div class="pattern-stat">T: ${tPercent}%</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        // ====================================
        // PLAYING MODE FUNCTIONS
        // ====================================

        function addPlayResult(result) {
            if (isProcessing) return;
            isProcessing = true;
            showLoading();
            
            AI.addPlayResult(result);
            updatePlayingUI();
            
            setTimeout(() => {
                hideLoading();
                isProcessing = false;
            }, 300);
        }

        function undoLast() {
            if (isProcessing || AI.playingHistory.length === 0) return;
            isProcessing = true;
            showLoading();
            
            AI.undoLastPlay();
            updatePlayingUI();
            showAlert('info', '‚Ü©Ô∏è ƒê√£ ho√†n t√°c');
            
            setTimeout(() => {
                hideLoading();
                isProcessing = false;
            }, 300);
        }

        function clearPlaying() {
            if (!confirm('X√≥a to√†n b·ªô l·ªãch s·ª≠ ch∆°i?')) return;
            
            showLoading();
            AI.clearPlaying();
            updatePlayingUI();
            
            setTimeout(() => {
                hideLoading();
                showAlert('info', 'üóëÔ∏è ƒê√£ x√≥a l·ªãch s·ª≠ ch∆°i');
            }, 300);
        }

        function updatePlayingUI() {
            updateCurrentPattern();
            updatePredictions();
            updatePatternMatches();
            updateRecommendations();
            updatePlayingStatistics();
            updateHistory();
        }

        function updateCurrentPattern() {
            const sequence = AI.getCurrentSequence();
            const display = document.getElementById('currentPatternDisplay');
            
            display.innerHTML = sequence.map(result => {
                if (result === '') {
                    return '<div class="pattern-item empty">?</div>';
                }
                const className = result === 'P' ? 'player' : result === 'B' ? 'banker' : 'tie';
                return `<div class="pattern-item ${className}">${result}</div>`;
            }).join('') + '<div class="pattern-item empty">?</div>';
        }

        function updatePredictions() {
            const predictions = AI.predictions;
            const currentPattern = AI.playingHistory.slice(-5).join('');
            const patternData = AI.patternDatabase.get(currentPattern);
            
            ['P', 'B', 'T'].forEach(type => {
                const prob = predictions[type] || 0;
                const count = patternData ? patternData[type] : 0;
                const label = type === 'P' ? 'Player' : type === 'B' ? 'Banker' : 'Tie';
                
                document.getElementById(`prob${label}`).textContent = prob.toFixed(1) + '%';
                document.getElementById(`conf${label}`).textContent = count + ' l·∫ßn';
                document.getElementById(`bar${label}`).style.width = prob + '%';
                
                const tile = document.getElementById(`pred${label}`);
                tile.classList.remove('hot', 'very-hot');
                if (prob > 60) {
                    tile.classList.add('very-hot');
                } else if (prob > 45) {
                    tile.classList.add('hot');
                }
            });
        }

        function updatePatternMatches() {
            const matchesDiv = document.getElementById('patternMatches');
            
            if (AI.playingHistory.length < 5) {
                matchesDiv.innerHTML = '<div style="color: #888; text-align: center;">C·∫ßn √≠t nh·∫•t 5 v√°n ƒë·ªÉ ph√¢n t√≠ch</div>';
                return;
            }
            
            const currentPattern = AI.playingHistory.slice(-5).join('');
            const matches = AI.findMatchingPatterns(currentPattern);
            
            if (matches.length === 0) {
                matchesDiv.innerHTML = '<div style="color: #888; text-align: center;">Kh√¥ng t√¨m th·∫•y pattern n√†y trong database</div>';
                return;
            }
            
            const match = matches[0];
            const total = match.counts.total;
            
            matchesDiv.innerHTML = `
                <div class="match-item">
                    <div class="match-pattern">${match.pattern}</div>
                    <div class="match-stats">
                        <div class="match-count">Xu·∫•t hi·ªán: ${total} l·∫ßn</div>
                    </div>
                </div>
                <div style="padding: 10px; color: #aaa; font-size: 0.9em;">
                    K·∫øt qu·∫£ ti·∫øp theo trong l·ªãch s·ª≠:<br>
                    P: ${match.counts.P} l·∫ßn (${((match.counts.P/total)*100).toFixed(1)}%)<br>
                    B: ${match.counts.B} l·∫ßn (${((match.counts.B/total)*100).toFixed(1)}%)<br>
                    T: ${match.counts.T} l·∫ßn (${((match.counts.T/total)*100).toFixed(1)}%)
                </div>
            `;
        }

        function updateRecommendations() {
            const container = document.getElementById('recommendCards');
            const predictions = AI.predictions;
            
            if (AI.playingHistory.length < 5) {
                container.innerHTML = '<div style="color: #888;">C·∫ßn √≠t nh·∫•t 5 v√°n ƒë·ªÉ AI ƒë·ªÅ xu·∫•t...</div>';
                return;
            }
            
            const currentPattern = AI.playingHistory.slice(-5).join('');
            const patternData = AI.patternDatabase.get(currentPattern);
            
            if (!patternData || patternData.total === 0) {
                container.innerHTML = '<div style="color: #888;">Kh√¥ng c√≥ d·ªØ li·ªáu cho chu·ªói n√†y trong database training</div>';
                return;
            }
            
            const sorted = Object.entries(predictions)
                .map(([type, prob]) => ({ type, prob }))
                .sort((a, b) => b.prob - a.prob);
            
            container.innerHTML = sorted.map((rec, i) => {
                const typeLabel = { 'P': 'CON', 'B': 'C√ÅI', 'T': 'H√íA' }[rec.type];
                const count = patternData[rec.type];
                return `
                    <div class="recommend-card ${i === 0 && rec.prob > 40 ? 'primary' : ''}">
                        <div class="recommend-bet">${typeLabel}</div>
                        <div class="recommend-confidence">${rec.prob.toFixed(1)}%</div>
                        <div class="recommend-reason">Xu·∫•t hi·ªán ${count}/${patternData.total} l·∫ßn</div>
                    </div>
                `;
            }).join('');
        }

        function updatePlayingStatistics() {
            document.getElementById('playedGames').textContent = AI.playingStats.gamesPlayed;
            document.getElementById('correctPredictions').textContent = AI.playingStats.correctPredictions;
            document.getElementById('accuracy').textContent = AI.getAccuracy().toFixed(1) + '%';
            
            const streak = AI.playingStats.currentStreak;
            document.getElementById('currentStreak').textContent = 
                streak.type ? `${streak.type} x${streak.count}` : '-';
        }

        function updateHistory() {
            const track = document.getElementById('historyTrack');
            document.getElementById('historyCount').textContent = AI.playingHistory.length;
            
            if (AI.playingHistory.length === 0) {
                track.innerHTML = '<div style="color: #888;">Ch∆∞a c√≥ d·ªØ li·ªáu</div>';
                return;
            }
            
            const recent = AI.playingHistory.slice(-30);
            track.innerHTML = recent.map(result => {
                const className = result === 'P' ? 'player' : result === 'B' ? 'banker' : 'tie';
                return `<div class="history-item ${className}">${result}</div>`;
            }).join('');
            
            track.scrollLeft = track.scrollWidth;
        }

        // ====================================
        // UTILITY FUNCTIONS
        // ====================================

        function showAlert(type, message) {
            const alert = document.getElementById('smartAlert');
            alert.className = `smart-alert ${type} show`;
            alert.textContent = message;
            setTimeout(() => alert.classList.remove('show'), 3000);
        }

        function setLoadingText(text) {
            document.getElementById('loadingText').textContent = text;
        }

        function showLoading() {
            setLoadingText('ƒêANG X·ª¨ L√ù...');
            document.getElementById('loadingOverlay').classList.add('show');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('show');
        }

        // ====================================
        // INITIALIZATION
        // ====================================
        document.addEventListener('DOMContentLoaded', () => {
            updateTrainingUI();
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (currentMode === 'playing') {
                if (e.key === '1' || e.key === 'p' || e.key === 'P') addPlayResult('P');
                else if (e.key === '2' || e.key === 'b' || e.key === 'B') addPlayResult('B');
                else if (e.key === '3' || e.key === 't' || e.key === 'T') addPlayResult('T');
                else if (e.key === 'z' && (e.ctrlKey || e.metaKey)) undoLast();
            }
        });
    </script>
</body>
</html>
